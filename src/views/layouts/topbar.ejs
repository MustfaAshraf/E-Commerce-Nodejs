<!-- Topbar Start -->
<div class="container-fluid px-5 py-4 d-none d-lg-block">
    <div class="row gx-0 align-items-center text-center">

        <!-- Logo -->
        <div class="col-md-4 col-lg-3 text-center text-lg-start">
            <div class="d-inline-flex align-items-center">
                <a href="/" class="navbar-brand p-0">
                    <h1 class="display-5 text-primary m-0">
                        <i class="fas fa-shopping-bag text-secondary me-2"></i>Electro
                    </h1>
                </a>
            </div>
        </div>

        <!-- Search -->
        <div class="col-md-4 col-lg-6 text-center">
            <div class="position-relative ps-4">
                <div class="d-flex border rounded-pill">
                    <input class="form-control border-0 rounded-pill w-100 py-3"
                        type="text" placeholder="Search Looking For?">
                    <button type="button" class="btn btn-primary rounded-pill py-3 px-5">
                        <i class="fas fa-search"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Right Section -->
        <div class="col-md-4 col-lg-3 text-center text-lg-end">
            <div class="d-inline-flex align-items-center">

                <% if (!isAuthenticated) { %>
                    <!-- Guest View -->
                    <a href="/login" class="text-muted d-flex align-items-center justify-content-center me-2">
                        <span class="rounded-pill border px-4 py-2 fw-semibold">Login</span>
                    </a>
                    <a href="/register" class="text-muted d-flex align-items-center justify-content-center">
                        <span class="rounded-pill border px-4 py-2 fw-semibold text-primary">Sign Up</span>
                    </a>

                <% } else { %>
                    <!-- Logged In View -->
                    
                    <!-- 1. User Profile -->
                    <a href="/users/profile" class="text-muted me-3" title="My Profile">
                        <span class="rounded-circle btn-md-square border">
                            <i class="fas fa-user"></i>
                        </span>
                    </a>

                    <!-- 2. CART ICON (New) -->
                    <!-- position-relative is needed so the badge knows where to stick -->
                    <a href="/my/cart" class="position-relative me-3 text-muted" title="View Cart">
                        <span class="rounded-circle btn-md-square border">
                            <i class="fas fa-shopping-bag"></i>
                        </span>
                    </a>

                    <!-- 3. Logout -->
                    <a href="/auth/logout" class="text-muted" title="Logout">
                        <span class="rounded-circle btn-md-square border">
                            <i class="fas fa-sign-out-alt"></i>
                        </span>
                    </a>
                    
                    <!-- Optional: Show Price next to icons -->
                    <!-- 
                    <% if (typeof cart !== 'undefined' && cart && cart.calculation) { %>
                        <div class="d-flex flex-column text-start ms-2">
                            <small class="text-muted" style="font-size: 10px;">Total</small>
                            <span class="fw-bold" style="font-size: 14px;">$<%= cart.calculation.total.toFixed(2) %></span>
                        </div>
                    <% } %> 
                    -->
                <% } %>

            </div>
        </div>
    </div>
</div>
<!-- Topbar End -->